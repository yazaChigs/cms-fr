!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("html2canvas"),require("xlsx"),require("html2pdf.js")):"function"==typeof define&&define.amd?define("ngx-export-as",["exports","@angular/core","rxjs","html2canvas","xlsx","html2pdf.js"],t):t((e=e||self)["ngx-export-as"]={},e.ng.core,e.rxjs,e.html2canvas,e.xlsx,e.html2pdf)}(this,(function(e,t,o,n,r,a){"use strict";n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a;function l(e,t,o,n){var r,a=arguments.length,l=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,o,n);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(l=(a<3?r(l):a>3?r(t,o,l):r(t,o))||l);return a>3&&l&&Object.defineProperty(t,o,l),l}function i(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}window.html2canvas=n;var c=function(){function e(){}return e.prototype.get=function(e){var t="get"+e.type.toUpperCase();return this[t]?this[t](e):o.Observable.create((function(e){e.error("Export type is not supported.")}))},e.prototype.save=function(e,t){return e.download=!0,e.fileName=t+"."+e.type,this.get(e)},e.prototype.contentToBlob=function(e){return o.Observable.create((function(t){for(var o=e.split(","),n=o[0].match(/:(.*?);/)[1],r=atob(o[1]),a=r.length,l=new Uint8Array(a);a--;)l[a]=r.charCodeAt(a);t.next(new Blob([l],{type:n})),t.complete()}))},e.prototype.removeFileTypeFromBase64=function(e){return/^data:[^]*;base64,/g[Symbol.replace](e,"")},e.prototype.addFileTypeToBase64=function(e,t){return"data:"+t+";base64,"+e},e.prototype.downloadFromDataURL=function(e,t){var o=this;this.contentToBlob(t).subscribe((function(t){o.downloadFromBlob(t,e)}))},e.prototype.downloadFromBlob=function(e,t){var o=window.URL.createObjectURL(e);if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{var n=document.createElement("a");n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.href=o,n.click(),document.body.removeChild(n)}},e.prototype.getPDF=function(e){var t=this;return o.Observable.create((function(o){e.options||(e.options={}),e.options.filename=e.fileName;var n=document.getElementById(e.elementIdOrContent),r=a().set(e.options).from(n||e.elementIdOrContent),l=e.download,i=e.options.pdfCallbackFn;l?(i?t.applyPdfCallbackFn(r,i).save():r.save(),o.next(),o.complete()):i?t.applyPdfCallbackFn(r,i).outputPdf("datauristring").then((function(e){o.next(e),o.complete()})):r.outputPdf("datauristring").then((function(e){o.next(e),o.complete()}))}))},e.prototype.applyPdfCallbackFn=function(e,t){return e.toPdf().get("pdf").then((function(e){t(e)}))},e.prototype.getPNG=function(e){var t=this;return o.Observable.create((function(o){var r=document.getElementById(e.elementIdOrContent);n(r,e.options).then((function(n){var r=n.toDataURL("image/PNG");"png"===e.type&&e.download?(t.downloadFromDataURL(e.fileName,r),o.next()):o.next(r),o.complete()}),(function(e){o.error(e)}))}))},e.prototype.getCSV=function(e){var t=this;return o.Observable.create((function(o){for(var n=[],r=document.getElementById(e.elementIdOrContent).querySelectorAll("table tr"),a=0;a<r.length;a++){for(var l=[],i=r[a].querySelectorAll("td, th"),c=0;c<i.length;c++){var s=i[c];l.push(s.innerText)}n.push(l.join(","))}var p="data:text/csv;base64,"+t.btoa(n.join("\n"));e.download?(t.downloadFromDataURL(e.fileName,p),o.next()):o.next(p),o.complete()}))},e.prototype.getTXT=function(e){var t=e.fileName.split(".");return e.fileName=t[0]+".txt",this.getCSV(e)},e.prototype.getXLS=function(e){var t=this;return o.Observable.create((function(o){var n=document.getElementById(e.elementIdOrContent),a=r.utils.table_to_sheet(n,e.options),l=r.utils.book_new();r.utils.book_append_sheet(l,a,e.fileName);var i="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+r.write(l,{type:"base64"});e.download?(t.downloadFromDataURL(e.fileName,i),o.next()):o.next(i),o.complete()}))},e.prototype.getXLSX=function(e){return this.getXLS(e)},e.prototype.getJSON=function(e){var t=this;return o.Observable.create((function(o){for(var n=[],r=[],a=document.getElementById(e.elementIdOrContent),l=0;l<a.rows[0].cells.length;l++)r[l]=a.rows[0].cells[l].innerHTML.toLowerCase().replace(/ /gi,"");for(var i=1;i<a.rows.length;i++){for(var c=a.rows[i],s={},p=0;p<c.cells.length;p++)s[r[p]]=c.cells[p].innerHTML;n.push(s)}var d=JSON.stringify(n),u="data:text/json;base64,"+t.btoa(d);e.download?(t.downloadFromDataURL(e.fileName,u),o.next()):o.next(n),o.complete()}))},e.prototype.getXML=function(e){var t=this;return o.Observable.create((function(o){for(var n='<?xml version="1.0" encoding="UTF-8"?><Root><Classes>',r=document.getElementById(e.elementIdOrContent).getElementsByTagName("tr"),a=0;a<r.length;a++){var l=r[a];if(l.cells.length>0){n+='<Class name="'+l.cells[0].textContent+'">\n';for(var i=1;i<l.cells.length;++i)n+="\t<data>"+l.cells[i].textContent+"</data>\n";n+="</Class>\n"}}n+="</Classes></Root>";var c="data:text/xml;base64,"+t.btoa(n);e.download?(t.downloadFromDataURL(e.fileName,c),o.next()):o.next(c),o.complete()}))},e.prototype.btoa=function(e){return btoa(unescape(encodeURIComponent(e)))},e=l([t.Injectable(),i("design:paramtypes",[])],e)}(),s=function(){function e(){}return e=l([t.NgModule({providers:[c]})],e)}();e.ExportAsModule=s,e.ExportAsService=c,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-export-as.umd.min.js.map